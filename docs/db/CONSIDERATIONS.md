# Database Considerations

ERM generated by PgAdmin:

![Database ERM](ERM.png 'Database ERM')

## Overview

I treated the database engine and data modelling choices to be the most crucial parts of this application. I spent the first 1.5-2 hours tweaking the data model, and building the database seed script.

For full disclosure, the DB seed script was written with help from ChatGPT, and a whole lot of prompting to tweak it.

I believe this step is the one I did the best in, as changes to the data model were very minimal once I actually started implementing the application.

## The Data Model

The data model is fairly simple, it is composed of 5 tables:

- Products
- Discounts
- Restrictions
- Orders
- Order Items

### Products

Simple table, not much detail to go into.

### Discounts

Table where we insert the main discount object. This object contains information on whether the discount has a fixed price or is percentage based. The amount of discount that it will give the user, and a user friendly explanation field to describe the discount.

### Restrictions

This is a many-to-one relationship table with Discounts. A discount can have many restrictions, each of which specifies a product that is required in the order so that a discount can be applied. It also includes a range property to define how many of each product is required.

### Orders

The orders table is actually fairly simple currently, only having an ID and CREATED_DATE. This table can be extended greatly, to include details on whether the order has been paid, has been checked out, has been cancelled. We could potentially calculate the order's total cost and discounted cost too, although I tried that and ended up being much easier to implement through code :)

### Order Items

The order items table is a many-to-many bridging table between ORDERS and PRODUCTS. Every product that has been added to an order will be present in the order items table. It's Primary Key is a composite key of PRODUCT_ID and ORDER_ID.

## Areas of Improvement

### Discount Amount

Currently, nothing stops you from creating a DISCOUNT with PERCENTAGE type and an amount of 1.0 or greater. For now, I will just end up owning you money :)

### Restriction Range

Currently, there is no logic implemented for the upper bound of the restriction's range. That means, currently this application only asserts that a minimum required amount of products is on the shopping cart for a discount to be applied.

The logic for the upper bound would be a bit more complex, and I had no guidelines whether I should give the discount twice if the full range was met twice, or if the discount shouldn't be given if the product's amount went over the upper limit, etc.

### Order Checkout Inventory Check

Currently, an order can be checked out even if the user has added more products to the order than there are in stock.
